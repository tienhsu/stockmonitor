## ADDED Requirements

### Requirement: 实时数据轮询 (Real-time Data Polling)
系统必须按固定间隔（默认：3秒）从配置的 API 源获取股票市场数据（价格、涨跌幅、百分比）。

#### Scenario: 可配置间隔
- **WHEN** 用户在设置中将刷新间隔更新为 5 秒
- **THEN** 对活动数据源的请求必须大致每 5 秒发生一次（±网络延迟）

#### Scenario: 隐藏时暂停（可选优化）
- **WHEN** 悬浮窗口处于隐藏状态 **且** “隐藏时暂停”设置已启用
- **THEN** 数据获取必须暂停，直到窗口再次可见

### Requirement: 多源故障转移 (Multi-Source Failover)
系统必须支持多个数据提供商（新浪、腾讯、东财），并在主动源发生故障时自动切换到备用源。

#### Scenario: 主源故障
- **WHEN** 对主源（例如新浪）的请求连续 3 次失败或超时
- **THEN** 系统必须自动切换到备用源（例如腾讯）进行后续请求

#### Scenario: 源恢复
- **WHEN** 系统已切换到备用源
- **THEN** 系统可以在预设时间段（例如 5 分钟）后或应用重启时尝试恢复到主源

### Requirement: 市场数据标准化 (Market Data Normalization)
系统必须将来自不同源的数据标准化为一致的内部格式以供显示。

#### Scenario: 价格格式
- **WHEN** 收到任意源的数据
- **THEN** 价格必须四舍五入到 2 位小数（或源精度）
- **AND** 涨跌幅百分比必须相对于前收盘价计算

#### Scenario: 股票代码自动识别
- **WHEN** 用户输入不带前缀的股票代码（例如“600519”）
- **THEN** 系统必须根据标准交易所规则自动识别市场（例如“sh”）
